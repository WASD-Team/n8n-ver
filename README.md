# n8n Version Manager

Web-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞, –∞—É–¥–∏—Ç–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π workflow –∏–∑ n8n.

## üìã –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- üìä –°–ø–∏—Å–æ–∫ workflow —Å –≥—Ä—É–ø–ø–∏—Ä–æ–≤–∫–æ–π –ø–æ –≤–µ—Ä—Å–∏—è–º
- üîç –ü—Ä–æ—Å–º–æ—Ç—Ä –¥–µ—Ç–∞–ª–µ–π –≤–µ—Ä—Å–∏–π –∏ diff-—Å—Ä–∞–≤–Ω–µ–Ω–∏–µ
- ‚öôÔ∏è –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∏ —É–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π —á–µ—Ä–µ–∑ API
- üë• –ú—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å - –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ n8n –≤ –æ–¥–Ω–æ–º –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ
- üîê –°–∏—Å—Ç–µ–º–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏—è–º–∏
- üìù –ê—É–¥–∏—Ç –ª–æ–≥ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –í–∞—Ä–∏–∞–Ω—Ç 1: Production –¥–µ–ø–ª–æ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–î–ª—è –∑–∞–ø—É—Å–∫–∞ –≥–æ—Ç–æ–≤–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å PostgreSQL –æ–¥–Ω–æ–π –∫–æ–º–∞–Ω–¥–æ–π:**

```bash
cd deploy
cp .env.example .env
# –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π .env - –∏–∑–º–µ–Ω–∏ –ø–∞—Ä–æ–ª–∏ –∏ –¥–æ–±–∞–≤—å ENCRYPTION_KEY
docker compose up -d
```

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –±—É–¥–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ –ø–æ –∞–¥—Ä–µ—Å—É: **http://localhost:3000**

üìñ **–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ production –¥–µ–ø–ª–æ—é:** [deploy/README.md](deploy/README.md)

### –í–∞—Ä–∏–∞–Ω—Ç 2: –õ–æ–∫–∞–ª—å–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞

**–î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏ –æ—Ç–ª–∞–¥–∫–∏:**

1. –£—Å—Ç–∞–Ω–æ–≤–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:

```bash
npm install
```

2. –ü–æ–¥–Ω–∏–º–∏ –ª–æ–∫–∞–ª—å–Ω—É—é –ë–î:

```bash
docker compose -f docker-compose.local.yml up -d
```

3. –°–æ–∑–¥–∞–π `.env.local`:

```bash
cp .env.example .env.local
```

–û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π `.env.local`:

```env
DATABASE_URL=postgres://app_user:app_pass@localhost:5432/app_db
ENCRYPTION_KEY=—Ç–≤–æ–π_–∫–ª—é—á_–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞
N8N_BASE_URL=https://—Ç–≤–æ–π-n8n.example.com
```

4. –ó–∞–ø—É—Å—Ç–∏ dev —Å–µ—Ä–≤–µ—Ä:

```bash
npm run dev
```

–û—Ç–∫—Ä–æ–π http://localhost:3000 –≤ –±—Ä–∞—É–∑–µ—Ä–µ.

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

### –°—Ç–µ–∫ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–π

- **Frontend:** Next.js 16 (App Router), React 19, TypeScript
- **Styling:** Tailwind CSS 4
- **Database:** PostgreSQL 16
- **Runtime:** Node.js 20
- **Deployment:** Docker, GitHub Actions

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç PostgreSQL —Å –¥–≤—É–º—è –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö:

1. **app_db** - –æ—Å–Ω–æ–≤–Ω–∞—è –±–∞–∑–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - `users` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –∏ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è
   - `settings` - –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ versions_db
   - `audit_log` - –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π
   - `workflow_groups` - –≥—Ä—É–ø–ø—ã workflow
   - `instances` - –º—É–ª—å—Ç–∏—Ç–µ–Ω–∞–Ω—Ç–Ω–æ—Å—Ç—å (–Ω–µ—Å–∫–æ–ª—å–∫–æ n8n –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤)
   - `invite_tokens` - —Ç–æ–∫–µ–Ω—ã –ø—Ä–∏–≥–ª–∞—à–µ–Ω–∏–π

2. **versions_db** - –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –≤–µ—Ä—Å–∏–π workflow
   - `version` - –∏—Å—Ç–æ—Ä–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π workflow –∏–∑ n8n
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ UI —á–µ—Ä–µ–∑ —Å—Ç—Ä–∞–Ω–∏—Ü—É Settings

### Docker –æ–±—Ä–∞–∑—ã

- **Production –æ–±—Ä–∞–∑:** `ghcr.io/altvk88/n8n-ver-web:latest`
- **–°–±–æ—Ä–∫–∞:** GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–±–∏—Ä–∞–µ—Ç –æ–±—Ä–∞–∑ –ø—Ä–∏ push –≤ –≤–µ—Ç–∫—É `auto-deploy`
- **–¢–µ–≥–∏:** `latest` (–ø–æ—Å–ª–µ–¥–Ω—è—è –≤–µ—Ä—Å–∏—è) –∏ `{commit_sha}` (–∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π –∫–æ–º–º–∏—Ç)

## üì¶ –ü—Ä–æ—Ü–µ—Å—Å –¥–µ–ø–ª–æ—è

### 1. –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

–†–∞–±–æ—Ç–∞–π –≤ –ª–æ–∫–∞–ª—å–Ω–æ–π —Å—Ä–µ–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:

```bash
npm run dev
```

### 2. –ö–æ–º–º–∏—Ç –∏–∑–º–µ–Ω–µ–Ω–∏–π

```bash
git add .
git commit -m "–æ–ø–∏—Å–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π"
git push origin auto-deploy
```

### 3. –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–±–æ—Ä–∫–∞

GitHub Actions –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏:
- –°–æ–±–∏—Ä–∞–µ—Ç Docker –æ–±—Ä–∞–∑
- –ü—É–±–ª–∏–∫—É–µ—Ç –≤ GitHub Container Registry —Å —Ç–µ–≥–∞–º–∏ `latest` –∏ `{commit_sha}`
- –ü—Ä–æ—Ü–µ—Å—Å –∑–∞–Ω–∏–º–∞–µ—Ç ~2 –º–∏–Ω—É—Ç—ã

–ü—Ä–æ–≤–µ—Ä—å —Å—Ç–∞—Ç—É—Å —Å–±–æ—Ä–∫–∏:

```bash
gh run list --repo altvk88/n8n-ver --branch auto-deploy --limit 1
```

### 4. –î–µ–ø–ª–æ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–π —Å–±–æ—Ä–∫–∏ –æ–±–Ω–æ–≤–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ:

```bash
cd deploy
docker compose pull web
docker compose up -d web
```

Docker –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–∫–∞—á–∞–µ—Ç –ø–æ—Å–ª–µ–¥–Ω–∏–π –æ–±—Ä–∞–∑ (`latest` tag) –±–ª–∞–≥–æ–¥–∞—Ä—è `pull_policy: always`.

## üîß –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Production (.env –≤ –ø–∞–ø–∫–µ deploy/)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –û–±—è–∑–∞—Ç–µ–ª—å–Ω–∞—è | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----------|--------------|----------|
| `POSTGRES_USER` | –ù–µ—Ç (default: app_user) | –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å PostgreSQL |
| `POSTGRES_PASSWORD` | **–î–∞** | –ü–∞—Ä–æ–ª—å PostgreSQL |
| `POSTGRES_PORT` | –ù–µ—Ç (default: 5432) | –ü–æ—Ä—Ç PostgreSQL |
| `ENCRYPTION_KEY` | **–î–∞** | –ö–ª—é—á —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è (–º–∏–Ω. 32 —Å–∏–º–≤–æ–ª–∞) |
| `N8N_BASE_URL` | –ù–µ—Ç | –ë–∞–∑–æ–≤—ã–π URL n8n –∏–Ω—Å—Ç–∞–Ω—Å–∞ |
| `N8N_WEBHOOK_URL` | –ù–µ—Ç | URL webhook –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π |
| `N8N_API_KEY` | –ù–µ—Ç | API –∫–ª—é—á n8n |
| `WEB_PORT` | –ù–µ—Ç (default: 3000) | –ü–æ—Ä—Ç –≤–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è |

### Development (.env.local –≤ –∫–æ—Ä–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞)

```env
DATABASE_URL=postgres://app_user:app_pass@localhost:5432/app_db
ENCRYPTION_KEY=–º–∏–Ω–∏–º—É–º_32_—Å–∏–º–≤–æ–ª–∞_–¥–ª—è_—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
N8N_BASE_URL=https://your-n8n.example.com
N8N_WEBHOOK_URL=https://your-n8n.example.com/webhook/–≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
N8N_API_KEY=–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

## üîê –ü–µ—Ä–≤—ã–π –∑–∞–ø—É—Å–∫

1. –ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—Ç–∫—Ä–æ–π http://localhost:3000/login
2. –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞—Å—Ç –ø–µ—Ä–≤–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (bootstrap)
3. –ó–∞–π–¥–∏ –≤ **Settings** –∏ –Ω–∞—Å—Ç—Ä–æ–π –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ versions_db:
   - **Host:** `postgres` (–≤ Docker) –∏–ª–∏ `localhost` (–ª–æ–∫–∞–ª—å–Ω–æ)
   - **Port:** `5432`
   - **Database:** `versions_db`
   - **User:** `versions_user`
   - **Password:** `versions_pass`
   - **SSL Mode:** `disable`

## üìú NPM Scripts

- `npm run dev` - –∑–∞–ø—É—Å—Ç–∏—Ç—å dev —Å–µ—Ä–≤–µ—Ä —Å hot-reload
- `npm run build` - production —Å–±–æ—Ä–∫–∞
- `npm run start` - –∑–∞–ø—É—Å—Ç–∏—Ç—å production —Å–µ—Ä–≤–µ—Ä
- `npm run lint` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∫–æ–¥–∞ ESLint

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
n8n-versioning/
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app/              # Next.js App Router (—Å—Ç—Ä–∞–Ω–∏—Ü—ã + API routes)
‚îÇ   ‚îú‚îÄ‚îÄ components/       # React –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ lib/              # –£—Ç–∏–ª–∏—Ç—ã –∏ stores (db, auth, versionsStore –∏ —Ç.–¥.)
‚îÇ   ‚îî‚îÄ‚îÄ middleware.ts     # Middleware –¥–ª—è –∑–∞—â–∏—Ç—ã —Ä–æ—É—Ç–æ–≤
‚îú‚îÄ‚îÄ docker/
‚îÇ   ‚îî‚îÄ‚îÄ postgres/init/    # SQL —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î (–¥–ª—è dev)
‚îú‚îÄ‚îÄ deploy/               # Production –¥–µ–ø–ª–æ–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ init/             # SQL —Å–∫—Ä–∏–ø—Ç—ã –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ –ë–î (–¥–ª—è prod)
‚îÇ   ‚îú‚îÄ‚îÄ docker-compose.yml
‚îÇ   ‚îú‚îÄ‚îÄ .env.example
‚îÇ   ‚îî‚îÄ‚îÄ README.md         # –ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é
‚îú‚îÄ‚îÄ scripts/              # –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ —Å–∫—Ä–∏–ø—Ç—ã
‚îú‚îÄ‚îÄ .github/workflows/    # GitHub Actions CI/CD
‚îú‚îÄ‚îÄ Dockerfile            # Multi-stage Docker —Å–±–æ—Ä–∫–∞
‚îî‚îÄ‚îÄ docker-compose.yml    # Production compose (—Ç–æ–ª—å–∫–æ web)
```

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- üìñ [–ü–æ–¥—Ä–æ–±–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –¥–µ–ø–ª–æ—é](deploy/README.md)
- üìã [–†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –±—ã—Å—Ç—Ä–æ–º—É —Å—Ç–∞—Ä—Ç—É](deploy/QUICKSTART.md)
- üèóÔ∏è [–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã](deploy/ARCHITECTURE.md)
- üóÑÔ∏è [SQL Schema - —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö](SQL_SCHEMA.md)
- üìù [Changelog](deploy/CHANGELOG.md)
- üêô [GitHub —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π](https://github.com/altvk88/n8n-ver)
- üì¶ [Docker –æ–±—Ä–∞–∑](https://ghcr.io/altvk88/n8n-ver-web)
